{
  "version": "2.0.0",
  "tasks": [
    {
      "label": "Compile Project",
      "type": "shell",
      "isBuildCommand": true,
      "command": "cmake -B ${workspaceFolder}/build && cmake --build ${workspaceFolder}/build -- -j4",
      "group": "build",
      "presentation": {
        "reveal": "always",
        "panel": "dedicated"
      },
      "problemMatcher": "$gcc"
    },
    {
      "label": "Format Project with clang-format",
      "type": "shell",
      "command": "find . -type f \\( -name '*.cpp' -o -name '*.h' -o -name '*.hpp' -o -name '*.c' -o -name '*.cc' \\) -exec /Library/Developer/CommandLineTools/usr/bin/clang-format -i --style=file:/Users/jamie/.clang-format {} +",
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "new"
      }
    },
    {
      "label": "Run Project",
      "type": "process",
      "command": "${env:HOME}/.pico-sdk/picotool/2.2.0-a4/picotool/picotool",
      "args": ["load", "${command:raspberry-pi-pico.launchTargetPath}", "-fx"],
      "presentation": {
        "reveal": "always",
        "panel": "dedicated"
      },
      "problemMatcher": [],
      "windows": {
        "command": "${env:USERPROFILE}/.pico-sdk/picotool/2.2.0-a4/picotool/picotool.exe"
      }
    },
    {
      "label": "Flash",
      "type": "process",
      "command": "${userHome}/.pico-sdk/openocd/0.12.0+dev/openocd.exe",
      "args": [
        "-s",
        "${userHome}/.pico-sdk/openocd/0.12.0+dev/scripts",
        "-f",
        "interface/cmsis-dap.cfg",
        "-f",
        "target/${command:raspberry-pi-pico.getTarget}.cfg",
        "-c",
        "adapter speed 5000; program \"${command:raspberry-pi-pico.launchTargetPath}\" verify reset exit"
      ],
      "problemMatcher": [],
      "windows": {
        "command": "${env:USERPROFILE}/.pico-sdk/openocd/0.12.0+dev/openocd.exe"
      }
    },
    {
      "label": "Rescue Reset",
      "type": "process",
      "command": "${userHome}/.pico-sdk/openocd/0.12.0+dev/openocd.exe",
      "args": [
        "-s",
        "${userHome}/.pico-sdk/openocd/0.12.0+dev/scripts",
        "-f",
        "interface/cmsis-dap.cfg",
        "-f",
        "target/${command:raspberry-pi-pico.getChip}-rescue.cfg",
        "-c",
        "adapter speed 5000; reset halt; exit"
      ],
      "problemMatcher": [],
      "windows": {
        "command": "${env:USERPROFILE}/.pico-sdk/openocd/0.12.0+dev/openocd.exe"
      }
    },
    {
      "label": "RISC-V Reset (RP2350)",
      "type": "process",
      "command": "${userHome}/.pico-sdk/openocd/0.12.0+dev/openocd.exe",
      "args": [
        "-s",
        "${userHome}/.pico-sdk/openocd/0.12.0+dev/scripts",
        "-c",
        "set USE_CORE { rv0 rv1 cm0 cm1 }",
        "-f",
        "interface/cmsis-dap.cfg",
        "-f",
        "target/rp2350.cfg",
        "-c",
        "adapter speed 5000; init;",
        "-c",
        "write_memory 0x40120158 8 { 0x3 }; echo [format \"Info : ARCHSEL 0x%02x\" [read_memory 0x40120158 8 1]];",
        "-c",
        "reset halt; targets rp2350.rv0; echo [format \"Info : ARCHSEL_STATUS 0x%02x\" [read_memory 0x4012015C 8 1]]; exit"
      ],
      "problemMatcher": [],
      "windows": {
        "command": "${env:USERPROFILE}/.pico-sdk/openocd/0.12.0+dev/openocd.exe"
      }
    }
  ]
}
